aal "dbus_first_test" {
    language "python" {
        from test_mrp_dbus import *
    }

    # preview-hide-vars:
    # preview-depth: 5
    variables {
        set_created
    }

    initial_state {
        set_created = False
    }

    input "create_set" {
        guard { return not set_created }
        body { set_created = True }
        adapter {
            connect()
            create_res_set()
            add_resource()
        }
    }

    tag "set available" {
        guard { return set_created }

        input "acquire set" {
            adapter {
                acquire_set()
            }
        }

        input "release set" {
            adapter {
                release_set()
            }
        }

        input "disconnect" {
            body {
                set_created = False
            }
            adapter {
                disconnect()
            }
        }
    }
}
